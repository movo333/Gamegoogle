<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>Super Pio</title>
<!-- Google Sign-In SDK -->
<script src="https://accounts.google.com/gsi/client" async defer></script>
<!-- AdMob placeholder -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-app-pub-1152901043073265~9762922173" crossorigin="anonymous"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;user-select:none;}
html,body{width:100%;height:100%;overflow:hidden;background:#000;font-family:'Arial',sans-serif;}
#app{width:100vw;height:100vh;position:relative;overflow:hidden;}

/* ‚îÄ‚îÄ SCREENS ‚îÄ‚îÄ */
.screen{position:absolute;inset:0;display:none;flex-direction:column;align-items:center;justify-content:center;}
.screen.active{display:flex;}

/* ‚îÄ‚îÄ LOADING SCREEN ‚îÄ‚îÄ */
#loadingScreen{
  background: #0a0a1a;
  overflow:hidden;
}
#loadBG{
  position:absolute;inset:0;
  background-size:cover;background-position:center;
  opacity:0;transition:opacity 0.5s;
}
#loadBG.show{opacity:1;}
.load-logo{
  font-size:48px;font-weight:900;color:#FFD700;
  text-shadow:0 0 30px #FF6B00,4px 4px 0 #8B0000;
  letter-spacing:4px;margin-bottom:8px;
  animation:floatAnim 2s ease-in-out infinite;
  position:relative;z-index:2;
}
.load-sub{font-size:13px;color:#aaffaa;letter-spacing:3px;margin-bottom:40px;position:relative;z-index:2;}
.ld-bar-wrap{width:70%;max-width:280px;background:rgba(255,255,255,0.12);border-radius:20px;height:8px;overflow:hidden;position:relative;z-index:2;}
.ld-bar{height:100%;background:linear-gradient(90deg,#FFD700,#FF6B00);border-radius:20px;width:0%;transition:width .25s ease;}
.ld-txt{color:#888;font-size:12px;margin-top:10px;letter-spacing:1px;position:relative;z-index:2;}

/* ‚îÄ‚îÄ PI LOGIN ‚îÄ‚îÄ */
#piLogin{background:linear-gradient(180deg,#1a0a2e,#2d1b4e);}
.pi-sym{font-size:72px;margin-bottom:16px;}
.pi-ttl{font-size:28px;font-weight:900;color:#FFD700;margin-bottom:8px;}
.pi-sub{font-size:13px;color:#999;margin-bottom:32px;text-align:center;max-width:280px;line-height:1.6;}
.pi-btn{background:linear-gradient(135deg,#FFD700,#FF8C00);border:none;border-radius:40px;padding:16px 44px;font-size:17px;font-weight:900;color:#fff;cursor:pointer;letter-spacing:1px;}
.pi-skip{margin-top:14px;background:transparent;border:2px solid rgba(255,255,255,0.2);border-radius:28px;padding:10px 28px;color:#888;font-size:12px;cursor:pointer;}

/* ‚îÄ‚îÄ SPLASH / HOME SCREEN ‚îÄ‚îÄ */
#splash{
  background-size:cover;background-position:center;
  overflow:hidden;
}
#splashBG{position:absolute;inset:0;background-size:cover;background-position:bottom;}
.splash-overlay{position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,0.2),rgba(0,0,0,0.7));}
.splash-content{position:relative;z-index:2;display:flex;flex-direction:column;align-items:center;}
.splash-logo{font-size:62px;font-weight:900;color:#FFD700;text-shadow:0 0 40px #FF6B00,5px 5px 0 #8B0000;letter-spacing:6px;margin-bottom:4px;animation:floatAnim 3s ease-in-out infinite;}
.splash-sub{font-size:14px;color:#aaffaa;letter-spacing:3px;margin-bottom:50px;}
.btn-play-img{width:180px;cursor:pointer;filter:drop-shadow(0 4px 15px rgba(255,200,0,0.5));transition:transform 0.1s;}
.btn-play-img:active{transform:scale(0.93);}

/* ‚îÄ‚îÄ WORLD SELECT SCREEN ‚îÄ‚îÄ */
#worldSelect{background:#0a1628;overflow:hidden;}
#worldBG{position:absolute;inset:0;background-size:cover;background-position:center;opacity:0.3;}
.ws-title{font-size:22px;font-weight:900;color:#FFD700;letter-spacing:3px;margin-bottom:24px;position:relative;z-index:2;}
.worlds-row{position:relative;z-index:2;width:100%;overflow:hidden;}
.worlds-sky{
  width:100%;height:45vh;
  background-size:cover;background-position:bottom;
  position:relative;
  display:flex;align-items:flex-end;justify-content:center;
  padding-bottom:10px;
}
.world-cards-container{
  display:flex;gap:12px;
  padding:0 20px;
  justify-content:center;
  position:relative;z-index:2;
}
.world-card{
  width:80px;text-align:center;cursor:pointer;position:relative;
  transition:transform 0.15s;
}
.world-card:active{transform:scale(0.92);}
.world-img{
  width:80px;height:80px;border-radius:12px;
  border:3px solid rgba(255,255,255,0.15);
  object-fit:cover;position:relative;
}
.world-img.locked{filter:brightness(0.35) saturate(0.2);}
.world-lock-icon{
  position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);
  font-size:28px;pointer-events:none;
}
.world-name{font-size:11px;color:#ddd;margin-top:5px;font-weight:700;}
.world-prog{font-size:10px;color:#888;margin-top:2px;}
.back-btn{
  position:absolute;top:16px;left:14px;
  background:rgba(0,0,0,0.55);border:2px solid rgba(255,255,255,0.25);
  border-radius:20px;padding:7px 14px;color:#fff;font-size:12px;cursor:pointer;
  z-index:10;
}

/* ‚îÄ‚îÄ LEVEL SELECT SCREEN ‚îÄ‚îÄ */
/* ‚îÄ‚îÄ LEVEL SELECT ‚îÄ‚îÄ */
#levelSelect{overflow:hidden;}
#levelBG{position:absolute;inset:0;background-size:cover;background-position:center;opacity:0.6;}
.level-select-overlay{position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,0.15),rgba(0,0,0,0.5));}
.ls-content{position:relative;z-index:2;display:flex;flex-direction:column;align-items:center;width:100%;height:100%;padding-top:60px;box-sizing:border-box;}
.ls-title{font-size:20px;font-weight:900;color:#FFD700;letter-spacing:3px;margin-bottom:14px;text-shadow:2px 2px 8px rgba(0,0,0,0.8);flex-shrink:0;}
.levels-scroll-wrap{
  width:92%;max-width:360px;flex:1;overflow-y:auto;
  background:rgba(0,0,0,0.55);border-radius:16px;padding:14px;
  touch-action:pan-y;overscroll-behavior:contain;
  -webkit-overflow-scrolling:touch;box-sizing:border-box;
  margin-bottom:8px;
}
.levels-grid-overlay{
  display:grid;grid-template-columns:repeat(5,1fr);
  gap:8px;align-items:center;justify-items:center;
}
.lv-btn{
  width:100%;aspect-ratio:1;border-radius:8px;border:none;
  font-size:13px;font-weight:900;cursor:pointer;position:relative;
  display:flex;align-items:center;justify-content:center;
  transition:transform 0.1s;
}
.lv-btn:active{transform:scale(0.88);}
.lv-btn.unlocked{background:linear-gradient(135deg,#4CAF50,#2E7D32);color:#fff;box-shadow:0 2px 8px rgba(0,0,0,0.4);}
.lv-btn.done{background:linear-gradient(135deg,#FFD700,#FF8C00);color:#fff;}
.lv-btn.done::after{content:'‚òÖ';position:absolute;top:-4px;right:-4px;font-size:10px;color:#FFD700;text-shadow:0 0 4px #000;}
.lv-btn.locked{background:rgba(0,0,0,0.45);color:rgba(255,255,255,0.2);cursor:not-allowed;}

/* ‚îÄ‚îÄ GAME SCREEN ‚îÄ‚îÄ */
#gameScreen{background:#000;padding:0;overflow:hidden;}
#gameWrapper{position:absolute;top:0;left:0;transform-origin:top left;}
#gameCanvas{display:block;image-rendering:crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:pixelated;}

/* ‚îÄ‚îÄ HUD ‚îÄ‚îÄ */
#hud{position:absolute;top:0;left:0;right:0;z-index:20;pointer-events:none;}
.hud-bar{
  display:flex;justify-content:space-between;align-items:center;
  padding:6px 10px;
  background:rgba(0,0,0,0.6);backdrop-filter:blur(4px);
}
.hi{display:flex;align-items:center;gap:3px;font-size:12px;font-weight:800;color:#fff;text-shadow:1px 1px 3px #000;}
.hi span:first-child{font-size:16px;}
.timer{font-size:18px;font-weight:900;color:#FFD700;min-width:36px;text-align:center;}
.timer.low{color:#FF4444;animation:pulseAnim .5s infinite;}

/* ‚îÄ‚îÄ AMMO DISPLAY ‚îÄ‚îÄ */
#ctrl-ammo{
  position:absolute;bottom:88px;right:14px;
  display:flex;flex-direction:column;align-items:center;gap:3px;
  z-index:20;pointer-events:none;
}
.ammo-label{font-size:9px;color:#FFD700;font-weight:700;letter-spacing:1px;}
.ammo-dots{display:flex;gap:3px;}
.ammo-dot{width:8px;height:8px;border-radius:50%;background:#FFD700;box-shadow:0 0 4px #FFD700;}
.ammo-dot.empty{background:rgba(255,255,255,0.15);box-shadow:none;}

/* ‚îÄ‚îÄ CONTROLS ‚îÄ‚îÄ */
#ctrl-left{position:absolute;bottom:14px;left:14px;display:flex;gap:8px;z-index:20;pointer-events:all;}
#ctrl-right{position:absolute;bottom:14px;right:14px;display:flex;gap:8px;z-index:20;pointer-events:all;}

.cb{
  width:58px;height:58px;border-radius:50%;
  border:2px solid rgba(255,255,255,0.4);
  background:rgba(0,0,0,0.35);
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;touch-action:none;overflow:hidden;
  backdrop-filter:blur(2px);
}
.cb img{width:70%;height:70%;object-fit:contain;pointer-events:none;}
.cb:active,.cb.on{background:rgba(255,255,255,0.2);border-color:rgba(255,255,255,0.7);}
.cb-jump{border-color:rgba(100,255,100,0.6);}
.cb-shoot{border-color:rgba(255,80,80,0.6);}

.pause-btn{
  font-size:11px;padding:5px 10px;
  background:rgba(0,0,0,0.5);
  border:2px solid rgba(255,255,255,0.3);
  border-radius:14px;color:#fff;cursor:pointer;pointer-events:all;
}

/* ‚îÄ‚îÄ WIN / LOSE / PAUSE OVERLAYS ‚îÄ‚îÄ */
#winScreen,#loseScreen{
  background:rgba(0,0,0,0.82);z-index:100;
  position:absolute;inset:0;
  display:none;flex-direction:column;align-items:center;justify-content:center;
}
#winScreen.active,#loseScreen.active{display:flex;}

.banner-img-wrap{position:relative;width:85%;max-width:360px;}
.banner-img-wrap img{width:100%;}
.banner-btns{
  position:absolute;bottom:12%;left:0;right:0;
  display:flex;gap:8px;justify-content:center;
}
.rbt{
  background:transparent;border:none;cursor:pointer;
  display:flex;flex-direction:column;align-items:center;
  transition:transform 0.1s;
}
.rbt:active{transform:scale(0.9);}
.rbt img{width:54px;height:54px;object-fit:contain;}
.rbt span{font-size:10px;color:#fff;font-weight:700;margin-top:3px;}
.revive-btn{
  background:transparent!important;
  border:none!important;
  box-shadow:none!important;
  padding:2px!important;
}

/* ‚îÄ‚îÄ SHOP SCREEN ‚îÄ‚îÄ */
#shopScreen{
  position:fixed;inset:0;
  background:rgba(0,0,0,0.92);z-index:9999;
  display:none;flex-direction:column;align-items:center;justify-content:center;
}
#shopScreen.active{display:flex;}
.shop-box{
  background:linear-gradient(180deg,#1a0a2e,#2d1b4e);
  border:3px solid #7B2FBE;border-radius:20px;
  padding:20px;width:88%;max-width:340px;
  max-height:80vh;overflow-y:auto;
  touch-action:pan-y;
  overscroll-behavior:contain;
  -webkit-overflow-scrolling:touch;
}
.shop-ttl{font-size:22px;font-weight:900;color:#FFD700;text-align:center;margin-bottom:14px;}
.si{
  background:rgba(255,255,255,0.05);border:2px solid rgba(123,47,190,0.4);
  border-radius:12px;padding:12px;margin-bottom:8px;
  display:flex;align-items:center;gap:10px;
}
.si-ico{font-size:30px;}
.si-inf{flex:1;}
.si-nm{font-size:13px;font-weight:700;color:#fff;}
.si-ds{font-size:11px;color:#999;margin-top:2px;}
.si-btn{
  background:linear-gradient(135deg,#FFD700,#FF8C00);
  border:none;border-radius:14px;padding:8px 12px;
  color:#fff;font-weight:900;font-size:12px;cursor:pointer;
}
.shop-close{
  display:block;width:100%;margin-top:12px;padding:12px;
  background:rgba(255,255,255,0.07);border:2px solid rgba(255,255,255,0.2);
  border-radius:12px;color:#fff;font-size:14px;font-weight:700;cursor:pointer;
}

/* ‚îÄ‚îÄ PAUSE OVERLAY ‚îÄ‚îÄ */
#pauseOv{
  display:none;position:absolute;inset:0;
  background:rgba(0,0,0,0.82);z-index:50;
  flex-direction:column;align-items:center;justify-content:center;
}
#pauseOv.show{display:flex;}
.pause-ttl{font-size:28px;font-weight:900;color:#FFD700;margin-bottom:24px;}
.pause-item{
  background:rgba(255,255,255,0.08);border:2px solid rgba(255,255,255,0.22);
  border-radius:24px;padding:12px 34px;color:#fff;
  font-size:14px;font-weight:700;cursor:pointer;margin:5px;
  width:200px;text-align:center;
}
.pause-item.green{background:linear-gradient(135deg,#4CAF50,#2E7D32);border:none;}

/* ‚îÄ‚îÄ HEART POPUP ‚îÄ‚îÄ */
.heart-popup{
  position:absolute;font-size:28px;
  animation:heartPop 1s ease-out forwards;
  pointer-events:none;z-index:30;
}
@keyframes heartPop{
  0%{transform:translateY(0) scale(1);opacity:1;}
  100%{transform:translateY(-60px) scale(1.5);opacity:0;}
}

/* ‚îÄ‚îÄ COIN PARTICLE ‚îÄ‚îÄ */
.coin-popup{
  position:absolute;font-size:20px;
  animation:coinPop 0.8s ease-out forwards;
  pointer-events:none;z-index:30;
}
@keyframes coinPop{
  0%{transform:translateY(0) scale(1);opacity:1;}
  100%{transform:translateY(-40px);opacity:0;}
}

/* ‚îÄ‚îÄ ANIMATIONS ‚îÄ‚îÄ */
@keyframes floatAnim{0%,100%{transform:translateY(0);}50%{transform:translateY(-12px);}}
@keyframes pulseAnim{0%,100%{transform:scale(1);}50%{transform:scale(1.08);}}
@keyframes popIn{from{opacity:0;transform:scale(0.82);}to{opacity:1;transform:scale(1);}}
@keyframes tileBreak{0%{transform:scale(1);}30%{transform:scale(1.2) rotate(5deg);}100%{transform:scale(0) rotate(15deg);opacity:0;}}

/* ‚îÄ‚îÄ LEADERBOARD SCREEN ‚îÄ‚îÄ */
#leaderboardScreen{
  position:fixed;inset:0;
  background:rgba(0,0,0,0.95);z-index:9999;
  display:none;flex-direction:column;align-items:center;
  padding-top:0;
}
#leaderboardScreen.active{display:flex;}
.lb-header{
  width:100%;background:linear-gradient(135deg,#1a0a2e,#2d1b4e);
  padding:16px 20px;display:flex;align-items:center;justify-content:space-between;
  border-bottom:2px solid #7B2FBE;flex-shrink:0;
}
.lb-title{font-size:20px;font-weight:900;color:#FFD700;letter-spacing:2px;}
.lb-close{background:rgba(255,255,255,0.1);border:2px solid rgba(255,255,255,0.2);
  border-radius:50%;width:36px;height:36px;color:#fff;font-size:16px;cursor:pointer;
  display:flex;align-items:center;justify-content:center;}
.lb-tabs{display:flex;gap:0;width:100%;flex-shrink:0;}
.lb-tab{
  flex:1;padding:10px 0;text-align:center;font-size:12px;font-weight:700;
  color:#888;cursor:pointer;border-bottom:3px solid transparent;
  background:rgba(0,0,0,0.4);transition:all 0.2s;
}
.lb-tab.active{color:#FFD700;border-bottom-color:#FFD700;background:rgba(255,215,0,0.08);}
.lb-body{
  flex:1;width:100%;overflow-y:auto;
  touch-action:pan-y;-webkit-overflow-scrolling:touch;
  padding:8px 0;
}
.lb-loading{
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  height:200px;color:#888;font-size:14px;gap:12px;
}
.lb-spinner{width:36px;height:36px;border:3px solid rgba(255,255,255,0.1);
  border-top-color:#FFD700;border-radius:50%;animation:spin 0.8s linear infinite;}
@keyframes spin{to{transform:rotate(360deg);}}
.lb-empty{text-align:center;color:#666;padding:40px 20px;font-size:13px;}
.lb-row{
  display:flex;align-items:center;gap:10px;
  padding:10px 16px;border-bottom:1px solid rgba(255,255,255,0.05);
  transition:background 0.15s;
}
.lb-row:active{background:rgba(255,255,255,0.04);}
.lb-row.me{background:rgba(255,215,0,0.08);border-left:3px solid #FFD700;}
.lb-rank{
  font-size:15px;font-weight:900;color:#888;min-width:32px;text-align:center;
}
.lb-rank.gold{color:#FFD700;font-size:18px;}
.lb-rank.silver{color:#C0C0C0;font-size:17px;}
.lb-rank.bronze{color:#CD7F32;font-size:16px;}
.lb-avatar{
  width:36px;height:36px;border-radius:50%;
  background:linear-gradient(135deg,#7B2FBE,#4a1a8e);
  display:flex;align-items:center;justify-content:center;
  font-size:14px;font-weight:900;color:#fff;flex-shrink:0;
}
.lb-info{flex:1;min-width:0;}
.lb-name{font-size:13px;font-weight:700;color:#fff;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.lb-detail{font-size:10px;color:#888;margin-top:2px;}
.lb-score{font-size:14px;font-weight:900;color:#FFD700;text-align:right;white-space:nowrap;}
.lb-my-rank{
  flex-shrink:0;width:100%;background:linear-gradient(135deg,#1a0a2e,#2d1b4e);
  border-top:2px solid #7B2FBE;padding:10px 16px;
  display:flex;align-items:center;gap:10px;
}
.lb-my-rank .lb-name{color:#FFD700;}

/* ‚îÄ‚îÄ SCROLLBAR ‚îÄ‚îÄ */
::-webkit-scrollbar{width:4px;}
::-webkit-scrollbar-track{background:rgba(255,255,255,0.05);}
::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.2);border-radius:4px;}

/* ‚îÄ‚îÄ SHOP CARDS ‚îÄ‚îÄ */
.shop-card{
  cursor:pointer;border-radius:14px;overflow:hidden;
  transition:transform 0.15s;border:2px solid rgba(255,255,255,0.1);
}
.shop-card:active{transform:scale(0.95);}

/* ‚îÄ‚îÄ EXIT DIALOG ‚îÄ‚îÄ */
#exitDialog{
  display:none;position:fixed;inset:0;background:rgba(0,0,0,0.75);
  z-index:9999;align-items:center;justify-content:center;
}
#exitDialog.show{display:flex;}
.exit-box{
  background:linear-gradient(135deg,#1a0a2e,#2d1b4e);
  border:3px solid #FFD700;border-radius:20px;
  padding:32px 28px;text-align:center;max-width:280px;width:90%;
}
.exit-title{font-size:20px;font-weight:900;color:#FFD700;margin-bottom:8px;}
.exit-sub{font-size:13px;color:#aaa;margin-bottom:24px;}
.exit-btns{display:flex;gap:12px;justify-content:center;}
.exit-yes{background:#e74c3c;border:none;border-radius:12px;padding:12px 28px;color:#fff;font-size:15px;font-weight:700;cursor:pointer;}
.exit-no{background:rgba(255,255,255,0.1);border:2px solid rgba(255,255,255,0.2);border-radius:12px;padding:12px 28px;color:#fff;font-size:15px;font-weight:700;cursor:pointer;}

/* ‚îÄ‚îÄ AD LOADING OVERLAY ‚îÄ‚îÄ */
#adOverlay{
  display:none;position:fixed;inset:0;background:#000;
  z-index:9998;flex-direction:column;align-items:center;justify-content:center;
}
#adOverlay.show{display:flex;}
.ad-timer{font-size:48px;font-weight:900;color:#FFD700;margin-bottom:8px;}
.ad-txt{font-size:14px;color:#aaa;}
</style>
</head>
<body>
<div id="app">

<!-- LOADING -->
<div class="screen active" id="loadingScreen">
  <div id="loadBG"></div>
  <div class="load-logo"> SUPER PIO</div>
  <div class="ld-bar-wrap"><div class="ld-bar" id="ldBar"></div></div>
  <div class="ld-txt" id="ldTxt">Loading...</div>
</div>

<!-- PI LOGIN -->
<div class="screen" id="piLogin">
  <div class="pi-sym">üéÆ</div>
  <div class="pi-ttl">Super Pio</div>
  <div class="pi-sub">Sign in to save your progress and compete on leaderboards!</div>
  <!-- Google One Tap -->
  <div id="g_id_onload"
       data-client_id="440239520472-n4hfnn0bp03cq7rj0qpge159ie5pas29"
       data-callback="onGoogleLogin"
       data-auto_prompt="false">
  </div>
  <div class="g_id_signin"
       data-type="standard"
       data-size="large"
       data-theme="filled_blue"
       data-text="sign_in_with"
       data-shape="pill"
       data-logo_alignment="left">
  </div>
  <div style="margin:16px 0;color:#555;font-size:12px;">‚Äî or ‚Äî</div>
  <button class="pi-skip" onclick="playGuest()">üïπÔ∏è Play as Guest</button>
</div>

<!-- SPLASH / HOME -->
<div class="screen" id="splash">
  <div id="splashBG"></div>
  <div class="splash-overlay"></div>
  <div class="splash-content">
    <div class="splash-logo">SUPER PIO</div>
    <div class="splash-sub">The game is in beta testing, so it's normal to find some bugs.</div>
    <img id="btnPlayImg" class="btn-play-img" src="assets/buttons/btn_play.png" onclick="showWorldSelect()" alt="PLAY" onerror="this.style.display='none';document.getElementById('btnPlayFallback').style.display='block'">
    <button id="btnPlayFallback" onclick="showWorldSelect()" style="display:none;background:linear-gradient(135deg,#FFD700,#FF6B00);border:none;border-radius:50px;padding:18px 56px;font-size:26px;font-weight:900;color:#fff;cursor:pointer;margin-top:10px;">‚ñ∂ PLAY</button>
  </div>
  <div style="position:absolute;bottom:24px;display:flex;gap:12px;z-index:2;">
    <button onclick="openShop()" style="background:rgba(123,47,190,0.5);border:2px solid #7B2FBE;border-radius:24px;padding:9px 20px;color:#fff;font-size:12px;cursor:pointer;">üõí Shop</button>
    <button onclick="showLeaderboard()" style="background:rgba(0,100,0,0.5);border:2px solid #4CAF50;border-radius:24px;padding:9px 20px;color:#fff;font-size:12px;cursor:pointer;">üèÜ Scores</button>
  </div>
  <div style="position:absolute;top:16px;right:14px;z-index:2;">
    <div id="piUserBadge" style="display:none;background:rgba(0,0,0,0.5);border:2px solid #FFD700;border-radius:20px;padding:5px 12px;font-size:11px;color:#FFD700;font-weight:700;"></div>
  </div>
</div>

<!-- WORLD SELECT -->
<div class="screen" id="worldSelect">
  <button class="back-btn" onclick="showScreen('splash')">‚Üê Back</button>
  <div id="worldBG"></div>
  <div class="ws-title" style="margin-top:60px;">SELECT WORLD</div>
  <div class="worlds-sky" id="worldsSkyBG">
    <div class="world-cards-container" id="worldsGrid"></div>
  </div>
</div>

<!-- LEVEL SELECT -->
<div class="screen" id="levelSelect">
  <button class="back-btn" onclick="showScreen('worldSelect')">‚Üê Back</button>
  <div id="levelBG"></div>
  <div class="level-select-overlay"></div>
  <div class="ls-content">
    <div class="ls-title" id="lvlSelTitle">WORLD 1</div>
    <div class="levels-scroll-wrap">
      <div class="levels-grid-overlay" id="levelsGrid"></div>
    </div>
  </div>
</div>

<!-- GAME SCREEN -->
<div class="screen" id="gameScreen">
  <div id="gameWrapper">
    <canvas id="gameCanvas"></canvas>

    <!-- HUD -->
    <div id="hud">
      <div class="hud-bar">
        <button class="pause-btn" onclick="pauseGame()">‚è∏</button>
        <div class="hi"><span>‚ù§Ô∏è</span><span id="hLives">3</span></div>
        <div class="hi"><span>‚≠ê</span><span id="hScore">0</span></div>
        <div class="timer" id="hTimer">120</div>
        <div class="hi"><img id="hudCoinImg" src="assets/buttons/coin.png" style="width:20px;height:20px;vertical-align:middle;margin-right:2px;" onerror="this.style.display='none';this.nextSibling.style.display=''"><span style="display:none">ü™ô</span><span id="hCoins">0</span></div>
      </div>
    </div>

    <!-- Ammo -->
    <div id="ctrl-ammo">
      <div class="ammo-label">AMMO</div>
      <div class="ammo-dots" id="ammoDots"></div>
    </div>

    <!-- LEFT controls -->
    <div id="ctrl-left">
      <div class="cb" id="btnL"
        ontouchstart="kd('left',true)" ontouchend="kd('left',false)" ontouchcancel="kd('left',false)">
        <img src="assets/buttons/btn_left.png" onerror="this.parentNode.innerHTML='‚óÄ'">
      </div>
      <div class="cb" id="btnR"
        ontouchstart="kd('right',true)" ontouchend="kd('right',false)" ontouchcancel="kd('right',false)">
        <img src="assets/buttons/btn_right.png" onerror="this.parentNode.innerHTML='‚ñ∂'">
      </div>
    </div>

    <!-- RIGHT controls -->
    <div id="ctrl-right">
      <div class="cb cb-shoot"
        ontouchstart="event.preventDefault();doShoot()"
        ontouchend="event.preventDefault()"
        onmousedown="doShoot()">
        <img src="assets/buttons/btn_shoot.png" onerror="this.parentNode.innerHTML='üî´'">
      </div>
      <div class="cb cb-jump" id="btnJump"
        ontouchstart="event.preventDefault();doJump()"
        ontouchend="event.preventDefault()"
        onmousedown="doJump()">
        <img src="assets/buttons/btn_Jumping.png" onerror="this.parentNode.innerHTML='‚¨ÜÔ∏è'" style="width:100%;height:100%;object-fit:contain;">
      </div>
    </div>

    <!-- WIN -->
    <div id="winScreen">
      <div class="banner-img-wrap" style="animation:popIn .35s ease;">
        <img src="assets/buttons/banner_win.png" alt="" onerror="this.style.opacity='0.01'">
        <div style="position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;padding-top:20%;">
          <div style="font-size:32px;font-weight:900;color:#FFD700;text-shadow:2px 2px 8px rgba(0,0,0,0.8);">üèÜ YOU WIN!</div>
          <div id="winStars" style="font-size:28px;margin:8px 0;">‚≠ê‚≠ê‚≠ê</div>
          <div id="winScore" style="font-size:13px;color:#ddd;margin-bottom:16px;"></div>
        </div>
        <div class="banner-btns">
          <button class="rbt" onclick="nextLevel()">
            <img src="assets/buttons/btn_right.png" onerror="this.parentNode.innerHTML='‚ñ∂ Next'">
            <span>Next</span>
          </button>
          <button class="rbt" onclick="retryLvl()">
            <img src="assets/buttons/btn_retry.png" onerror="this.parentNode.innerHTML='üîÑ'">
            <span>Retry</span>
          </button>
          <button class="rbt" onclick="openShop()">
            <img src="assets/buttons/btn_shop.png" onerror="this.parentNode.innerHTML='üõí'">
            <span>Shop</span>
          </button>
        </div>
      </div>
    </div>

    <!-- LOSE -->
    <div id="loseScreen">
      <div class="banner-img-wrap" style="animation:popIn .35s ease;">
        <img src="assets/buttons/banner_lose.png" alt="" onerror="this.style.opacity='0.01'">
        <div style="position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;padding-top:18%;">
          <div style="font-size:30px;font-weight:900;color:#FF4444;text-shadow:2px 2px 8px rgba(0,0,0,0.9);">üíÄ GAME OVER</div>
          <div id="loseReason" style="font-size:13px;color:#ddd;margin:10px 0 16px;"></div>
        </div>
        <div class="banner-btns">
          <button class="rbt" onclick="retryLvl()">
            <img src="assets/buttons/btn_retry.png" onerror="this.parentNode.innerHTML='üîÑ'">
            <span>Retry</span>
          </button>
          <button class="rbt revive-btn" onclick="revivePlayer()" id="reviveBtn">
            <img src="assets/buttons/Restart_button.png" style="width:54px;height:54px;object-fit:contain;" onerror="this.style.display='none'">
            <span style="font-size:9px;color:#FFD700;">REVIVE</span>
          </button>
          <button class="rbt" onclick="backToLevels()">
            <img src="assets/buttons/btn_left.png" onerror="this.parentNode.innerHTML='‚óÄ'">
            <span>Levels</span>
          </button>
          <button class="rbt" onclick="openShop()">
            <img src="assets/buttons/btn_shop.png" onerror="this.parentNode.innerHTML='üõí'">
            <span>Shop</span>
          </button>
        </div>
      </div>
    </div>

    <!-- PAUSE -->
    <div id="pauseOv">
      <div class="pause-ttl">‚è∏ PAUSED</div>
      <button class="pause-item green" onclick="resumeGame()">‚ñ∂ Resume</button>
      <button class="pause-item" onclick="retryLvl()">üîÑ Restart</button>
      <button class="pause-item" onclick="backToLevels()">üó∫Ô∏è Level Select</button>
    </div>

  </div><!-- #gameWrapper -->
</div><!-- #gameScreen -->

<!-- SHOP - outside gameWrapper to avoid rotation distortion -->
<div id="shopScreen">
  <div class="shop-box">
    <button onclick="closeShop()" style="position:absolute;top:10px;right:14px;background:rgba(0,0,0,0.35);border:2px solid rgba(255,255,255,0.25);border-radius:50%;width:38px;height:38px;font-size:18px;color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:10;">‚úï</button>
    <button onclick="closeShop()" style="position:absolute;top:10px;left:14px;background:rgba(0,0,0,0.35);border:2px solid rgba(255,255,255,0.25);border-radius:20px;padding:6px 14px;font-size:14px;color:#fff;cursor:pointer;display:flex;align-items:center;gap:6px;z-index:10;">‚óÄ Back</button>
    <div class="shop-ttl">üõí Store</div>

    <!-- ÿ™ÿ®ŸàŸäÿ®ÿßÿ™ -->
    <div style="display:flex;gap:8px;padding:0 8px 8px;justify-content:center;">
      <button id="tab-ads" onclick="switchShopTab('ads')" style="flex:1;padding:8px;border-radius:12px;border:none;background:#FFD700;color:#000;font-weight:800;font-size:13px;cursor:pointer;">üì∫ Free</button>
      <button id="tab-iap" onclick="switchShopTab('iap')" style="flex:1;padding:8px;border-radius:12px;border:2px solid #FFD700;background:transparent;color:#FFD700;font-weight:800;font-size:13px;cursor:pointer;">üíé Buy</button>
      <button id="tab-ref" onclick="switchShopTab('ref')" style="flex:1;padding:8px;border-radius:12px;border:2px solid #FFD700;background:transparent;color:#FFD700;font-weight:800;font-size:13px;cursor:pointer;">üë• Refer</button>
    </div>

    <!-- ÿ™ÿ®ŸàŸäÿ® ÿßŸÑÿ•ÿπŸÑÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ¨ÿßŸÜŸäÿ© -->
    <div id="shop-tab-ads" style="display:grid;grid-template-columns:1fr 1fr;gap:12px;padding:8px;">
      <div class="shop-card" onclick="watchAd('ammo')">
        <img src="assets/shop/ammo.png" style="width:100%;border-radius:12px;">
      </div>
      <div class="shop-card" onclick="watchAd('lives')">
        <img src="assets/shop/lives.png" style="width:100%;border-radius:12px;">
      </div>
      <div class="shop-card" onclick="watchAd('coins')">
        <img src="assets/shop/coins.png" style="width:100%;border-radius:12px;">
      </div>
      <div class="shop-card" onclick="watchAd('unlock')">
        <img src="assets/shop/unlock.png" style="width:100%;border-radius:12px;">
      </div>
    </div>

    <!-- ÿ™ÿ®ŸàŸäÿ® ÿßŸÑÿ¥ÿ±ÿßÿ° -->
    <div id="shop-tab-iap" style="display:none;grid-template-columns:1fr 1fr;gap:12px;padding:8px;">
      <div class="shop-card" onclick="buyIAP('next_level')">
        <img src="assets/shop/next_level.png" style="width:100%;border-radius:12px;" onerror="this.parentNode.innerHTML='<div style='padding:16px;text-align:center;color:#fff'>üîì<br><b>Next Level</b><br><span style='color:#FFD700'>$1.99</span></div>'">
      </div>
      <div class="shop-card" onclick="buyIAP('all_levels')">
        <img src="assets/shop/all_levels.png" style="width:100%;border-radius:12px;" onerror="this.parentNode.innerHTML='<div style='padding:16px;text-align:center;color:#fff'>üåç<br><b>All Levels</b><br><span style='color:#FFD700'>$3.99</span></div>'">
      </div>
      <div class="shop-card" onclick="buyIAP('coins_1000')">
        <img src="assets/shop/acoins.png" style="width:100%;border-radius:12px;" onerror="this.parentNode.innerHTML='<div style='padding:16px;text-align:center;color:#fff'>ü™ô<br><b>1000 Coins</b><br><span style='color:#FFD700'>$1.00</span></div>'">
      </div>
      <div class="shop-card" onclick="buyIAP('hearts_20')">
        <img src="assets/shop/hearts.png" style="width:100%;border-radius:12px;" onerror="this.parentNode.innerHTML='<div style='padding:16px;text-align:center;color:#fff'>‚ù§Ô∏è<br><b>20 Hearts</b><br><span style='color:#FFD700'>$1.00</span></div>'">
      </div>
    </div>

    <!-- Referral Tab -->
    <div id="shop-tab-ref" style="display:none;padding:16px;text-align:center;">
      <div style="font-size:40px;margin-bottom:12px;">üë•</div>
      <div style="color:#FFD700;font-size:16px;font-weight:800;margin-bottom:8px;">Referral Program</div>
      <div style="color:#aaa;font-size:13px;margin-bottom:20px;line-height:1.6;">Invite a friend and earn<br><span style="color:#FFD700;font-weight:800;font-size:18px;">5000 Coins</span> for every person who joins with your code!</div>
      <button onclick="getReferralCode()" style="width:100%;padding:14px;background:linear-gradient(135deg,#FFD700,#FF8C00);border:none;border-radius:14px;color:#000;font-size:15px;font-weight:900;cursor:pointer;margin-bottom:12px;">üì§ Share Referral Code</button>
      <button onclick="showReferralDialog()" style="width:100%;padding:14px;background:rgba(255,255,255,0.08);border:2px solid rgba(255,255,255,0.2);border-radius:14px;color:#fff;font-size:15px;font-weight:700;cursor:pointer;">üéÅ Enter Referral Code</button>
      <div style="margin-top:16px;padding:12px;background:rgba(255,215,0,0.08);border-radius:12px;color:#FFD700;font-size:12px;">
        Your Code: <b id="myRefCode">Login to get your referral code</b>
      </div>
    </div>
  </div>
</div>
<!-- LEADERBOARD SCREEN -->
<div id="leaderboardScreen">
  <div class="lb-header">
    <div class="lb-title">üèÜ Leaderboard</div>
    <button class="lb-close" onclick="closeLeaderboard()">‚úï</button>
  </div>
  <div class="lb-tabs">
    <div class="lb-tab active" id="lbTab-level"   onclick="switchLbTab('level')">üéÆ Max Level</div>
    <div class="lb-tab"       id="lbTab-coins"    onclick="switchLbTab('coins')">ü™ô Coins</div>
  </div>
  <div class="lb-body" id="lbBody">
    <div class="lb-loading"><div class="lb-spinner"></div><span>Loading...</span></div>
  </div>
  <div class="lb-my-rank" id="lbMyRank" style="display:none;">
    <div class="lb-rank" id="lbMyRankNum">#-</div>
    <div class="lb-avatar" id="lbMyAvatar">?</div>
    <div class="lb-info">
      <div class="lb-name" id="lbMyName">You</div>
      <div class="lb-detail" id="lbMyDetail"></div>
    </div>
    <div class="lb-score" id="lbMyScore">-</div>
  </div>
</div>


<!-- EXIT DIALOG -->
<div id="exitDialog">
  <div class="exit-box">
    <div class="exit-title">üö™ Exit Game?</div>
    <div class="exit-sub">Are you sure you want to exit?</div>
    <div class="exit-btns">
      <button class="exit-yes" onclick="confirmExit()">Yes</button>
      <button class="exit-no" onclick="cancelExit()">No</button>
    </div>
  </div>
</div>

<!-- AD OVERLAY -->
<div id="adOverlay">
  <div class="ad-timer" id="adTimer">5</div>
  <div class="ad-txt">Watch ad to get your reward...</div>
  <div style="margin-top:24px;width:90%;max-width:400px;height:250px;background:#111;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#555;font-size:13px;">
    üì∫ Ad plays here
  </div>
</div>
</div><!-- #app -->
<script src="js/levels.js"></script>
<script src="js/game.js"></script>
</body>
</html>
